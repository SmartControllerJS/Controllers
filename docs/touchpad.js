(()=>{var n=null,e=null,o=null;document.getElementById("receiver-id"),document.getElementById("status"),document.getElementById("message");const t=window.location.search,c=new URLSearchParams(t).get("id");var i=document.getElementsByClassName("input_canvas")[0];function l(n){n.preventDefault(),u("start",n.targetTouches)}function d(n){n.preventDefault(),u("move",n.targetTouches)}function s(n){n.preventDefault(),n.targetTouches.length,o.send(["end",0,0])}function u(n,e){if(o&&o.open){coordinates={};for(var t=0;t<e.length;t++)coordinates[t]=[e[t].clientX/i.width,e[t].clientY/i.height];var c=coordinates;o.send([n,e.length,c])}else console.log("Connection is closed")}function r(){o&&o.close(),(o=e.connect(c,{reliable:!0})).on("open",(function(){console.log("Connected to: "+o.peer)})),o.on("data",(function(n){})),o.on("close",(function(){}))}i.setAttribute("width",window.innerWidth),i.setAttribute("height",window.innerHeight),i.getContext("2d"),document.addEventListener("DOMContentLoaded",(function(n){var e=i;e.ontouchstart=l,e.ontouchmove=d,e.ontouchcancel=s,e.ontouchend=s})),(e=new Peer(null,{debug:2})).on("open",(function(o){null===e.id?(console.log("Received null id from peer open"),e.id=n):n=e.id,console.log("ID: "+e.id),r()})),e.on("connection",(function(n){n.on("open",(function(){n.send("Sender does not accept incoming connections"),setTimeout((function(){n.close()}),500)}))})),e.on("disconnected",(function(){console.log("Connection lost. Please reconnect"),e.id=n,e._lastServerId=n,e.reconnect()})),e.on("close",(function(){o=null,console.log("Connection destroyed")})),e.on("error",(function(n){console.log(n),alert(""+n)}))})();